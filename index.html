<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>Ø¯Ø±Ø®ÙˆØ§Ø³Øª ÛŒØ¯Ú©â€ŒÚ©Ø´ | Ù…Ú©Ø§Ù†ÛŒÚ© Ø³ÛŒØ§Ø±</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
*{box-sizing:border-box}
body{
  font-family:tahoma;
  margin:0;
  background:#f4f6f8;
}
.wrapper{
  max-width:420px;
  margin:25px auto;
  padding:15px;
}
.card{
  background:#fff;
  border-radius:14px;
  padding:20px;
  box-shadow:0 4px 12px rgba(0,0,0,.08);
}
h2{text-align:center;margin:0 0 15px}
input,select,textarea,button{
  width:100%;
  margin-top:10px;
  padding:11px;
  border-radius:8px;
  border:1px solid #ccc;
  font-size:15px;
}
textarea{min-height:70px}
button{
  border:none;
  font-weight:bold;
}
.btn-map{
  background:#0069d9;
  color:#fff;
}
.btn-send{
  background:#25D366;
  color:#fff;
  margin-top:14px;
}
#map{
  display:none;
  height:220px;
  margin-top:10px;
  border-radius:10px;
  overflow:hidden;
}
.small{
  font-size:13px;
  text-align:center;
  color:#666;
  margin-top:8px;
}
</style>
</head>

<body>

<div class="wrapper">
  <div class="card">

    <h2>ğŸš˜ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø®Ø¯Ù…Ø§Øª</h2>

    <select id="service">
      <option value="">Ù†ÙˆØ¹ Ø®Ø¯Ù…Ø§Øª</option>
      <option value="ÛŒØ¯Ú©â€ŒÚ©Ø´">ÛŒØ¯Ú©â€ŒÚ©Ø´</option>
      <option value="Ù…Ú©Ø§Ù†ÛŒÚ© Ø³ÛŒØ§Ø±">Ù…Ú©Ø§Ù†ÛŒÚ© Ø³ÛŒØ§Ø±</option>
    </select>

    <input id="name" placeholder="Ù†Ø§Ù…">
    <input id="phone" placeholder="Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³">
    <input id="plate" placeholder="Ø´Ù…Ø§Ø±Ù‡ Ù¾Ù„Ø§Ú©">
    <textarea id="desc" placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)"></textarea>

    <input type="hidden" id="lat">
    <input type="hidden" id="lng">

    <button class="btn-map" onclick="openMap()">ğŸ“ Ø§Ù†ØªØ®Ø§Ø¨ Ù…ÙˆÙ‚Ø¹ÛŒØª</button>
    <div id="map"></div>

    <button class="btn-send" onclick="sendWhatsApp()">ğŸ“² Ø§Ø±Ø³Ø§Ù„ Ø¯Ø± ÙˆØ§ØªØ³Ø§Ù¾</button>

    <div class="small">Ù¾Ø³ Ø§Ø² Ø¨Ø§Ø² Ø´Ø¯Ù† ÙˆØ§ØªØ³Ø§Ù¾ØŒ Ø§Ø±Ø³Ø§Ù„ Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯</div>

  </div>
</div>

<script>
let map, marker, leafletReady=false;

function loadLeaflet(cb){
  if(leafletReady){ cb(); return; }

  const css=document.createElement("link");
  css.rel="stylesheet";
  css.href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.css";

  const js=document.createElement("script");
  js.src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.js";
  js.onload=()=>{leafletReady=true;cb();};

  document.head.appendChild(css);
  document.body.appendChild(js);
}

function openMap(){
  document.getElementById("map").style.display="block";

  loadLeaflet(()=>{
    if(!map){
      map=L.map("map").setView([35.7,51.4],13);
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);
      map.on("click",e=>{
        const {lat,lng}=e.latlng;
        if(marker) map.removeLayer(marker);
        marker=L.marker([lat,lng]).addTo(map);
        latEl.value=lat;
        lngEl.value=lng;
      });
    }
  });
}

function sendWhatsApp(){
  if(!serviceEl.value||!nameEl.value||!phoneEl.value||!plateEl.value){
    alert("Ù„Ø·ÙØ§Ù‹ Ù‡Ù…Ù‡ ÙÛŒÙ„Ø¯Ù‡Ø§ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯");
    return;
  }
  if(!latEl.value){
    alert("Ù„Ø·ÙØ§Ù‹ Ù…ÙˆÙ‚Ø¹ÛŒØª Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯");
    return;
  }

  const link=`https://maps.google.com/?q=${latEl.value},${lngEl.value}`;
  const msg=`ğŸš¨ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø®Ø¯Ù…Ø§Øª Ø®ÙˆØ¯Ø±Ùˆ
ğŸ”§ ${serviceEl.value}
ğŸ‘¤ ${nameEl.value}
ğŸ“ ${phoneEl.value}
ğŸš˜ ${plateEl.value}
ğŸ“ ${descEl.value||"-"}
ğŸ“ ${link}`;

  const wa="989XXXXXXXXX"; // Ø´Ù…Ø§Ø±Ù‡ ÙˆØ§ØªØ³Ø§Ù¾
  window.open(`https://wa.me/${wa}?text=${encodeURIComponent(msg)}`);
}

const serviceEl=service;
const nameEl=name;
const phoneEl=phone;
const plateEl=plate;
const descEl=desc;
const latEl=lat;
const lngEl=lng;
</script>

</body>
</html>
